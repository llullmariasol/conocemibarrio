{% extends "base.html" %}

{% block content %}
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<style>
    .btn-primary {
        color: white;
        background-color: darkslategrey;
        border-color: white;
    }
    .btn-primary:hover {
        color: white;
        background-color: lightslategrey;
        border-color: #fff;
    }
    h1 {
        color: white;
    }
</style>

{% if args.error %}
    <br>
    <br>
    <button type="button" class="btn btn-info btn-lg" id="myBtn">Mostrar foros</button>
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Lo sentimos, no puedes ingresar</h4>
                </div>
                <div class="modal-body">
                    <p>{{ args.error }}</p>
                </div>
                <div class="modal-footer">
                    <a class="btn btn-primary" href="{% url 'registration:joinNeighborhood' %}" role="button">Unirme</a>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                </div>
            </div>

        </div>
    </div>
{% else %}

    {% if request.user.is_authenticated and user.is_superuser != 1 and user.groups.all.0.name != "neighborhood-admin" %}
    <br/>
    <div class="container">
        <h1>Foros</h1>
        <a class="btn btn-primary btn-lg" href="{% url 'forum:addPost' %}" role="button" style="width:100%">Crear un tema</a>
    </div>

    <br/>
    {% for post in posts %}
    <div class="container">
        <div class="alert alert-success" role="alert">
            <h4 class="alert-heading">
                <a href="{% url 'forum:postDetail' post.pk %}" class="alert-link" onmouseover="this.style.color='#d4bd22'"
                   onMouseOut="this.style.color='#000000'"
                >{{ post.title }}</a>
            </h4><small>(click para ver más)</small>
            <hr>
            {% if post.author.username == request.user.username %}
            <p class="mb-0">Publicado por <strong>vos</strong></p>
            <span style="text-align:right;">
                        <a href="{% url 'forum:deletePost' post.pk %}" class="badge badge-danger"
                           onClick="return confirm('¿Seguro que quieres borrar el tema del foro?');">
                        <strong>Eliminar</strong>
                    </a>
                    </span>
            {% else %}
            <p class="mb-0">Publicado por <strong>{{ post.author }}</strong></p>
            {% endif %}
        </div>
    </div>
    <br/>
    {% endfor %}
    <br/>
    {% endif %}
{% endif %}

<script>
    $(document).ready(function(){
        $("#myBtn").click(function(){
            $("#myModal").modal();
        });
    });
</script>
{% endblock content %}
